# 简化函数调⽤

在对象技术中，最重要的概念莫过于“接口” （interface）。
容易被理解和被使⽤的接⼝中：是开发良好向对象软件的关键。
本章将介绍几个使接口变得更简洁易⽤的重构⼿法。

最简单也最重要的⼀件事就是修改函数名称。
名称是程序写作者与阅读者交流的关键⼯具。
只要你能理解⼀段程序的功能，就应该⼤胆地使⽤Rename Method （273） 将你所知道的东⻄传达给其他⼈。

另外，你也可以（并且应该）在适当时机修改 变量名称 和 类名称。
不过，总体来说，修改名称只是相对⽐较简单的⽂本替换功夫，所以我没有为它们提供单独的重构项⽬。

函数参数在接⼝之中扮演⼗分重要的⻆⾊。
Add Parameter （275）和 Remove Parameter （277）都是很常⻅的重构⼿法。
刚接触⾯向对象技术的程序员往往使⽤很⻓的参数列，这在其他开发环境中是很典型的⽅式。
但是，使⽤对象技术，你可以保持参数列的简短，以下有⼀些相关的重构可以帮助你缩短参数列。
如果来⾃同⼀对象的多个值被当作参数传递，你可以运⽤ 
Preserve Whole Object （288）将它们替换为单⼀对象，从⽽缩短参数列。
如果此前并不存在这样⼀个对象，你可以运⽤
Introduce Parameter Object （295）将它创建出来。

如果函数参数来⾃该函数可获取的⼀个对象，则可以使⽤ Replace Parameter with Method （292）避免传递参数。
如果某些参数被⽤来在条件表达式中做选择依据，可以实施 Replace Parameter with Explicit Method（285）。
另外，还可以使⽤ Parameterize Method（285）为数个相似函数添加參数，将它们合并到⼀起。

关于缩减参数列的重构⼿法，Doug Lea对我提出了⼀个警告：
并发编程往往需要使⽤较⻓的参数列，因为这样你可以保证传递给函数的参数都是不可被修改的，
例如，内置型对象 和 值对象 ⼀定是不可变的。
通常，你可以使⽤ 不可变对象取代这样的⻓参数列，但另⼀⽅⾯你也必须对此类重构保持谨慎。 
多年来，我⼀直坚守⼀个很有价值的习惯：
明确地将 “修改对象状态”的函数（修改函数）和 “查询对象状态”的函数（查询函数）分开设计。
不知道多少次，我因为将这两种函数混在⼀起⽽麻烦缠身；
不知道多少次，我看到别⼈也因为同样的 原因⽽遇到同样的麻烦。
因此，如果我看到这两种函数混在⼀起，就会使⽤ Separate Query from Modiﬁer （279）将它们分开。

良好的接口只向⽤户展现必须展现的东西。
如果⼀个接⼜暴露了过多细节，你可以将不必要暴露的东西隐藏起来，从⽽改进接⼜的质量。
毫⽆疑问，所有数据都应该隐藏起来（希望你不需要我来告诉你这⼀点），同时，所有可以隐藏的函数都应该被隐藏起来。
进⾏重构时，你往往需要暂时暴露某些东西，最后再以 Hide Method （303）和 Remove Setting Method（300）将它们隐藏起来。

构造函数是 Java 和 C++ 中特别⿇烦的⼀个东西，因为它强迫你必须知道要创建的对象属于哪⼀个类，⽽你往往并不需要知道这⼀点。
你可以使⽤ Replace Constructor with Factory Method（304）避免了解这不必要的信息。

转型是Java程序员⼼中另⼀处永远的痛。
你应该尽量使⽤ Encapsulate Downcast （308）将 向下转型 封装隐藏起来，避免让⽤户做那种动作。

和许多现代编程语⾔⼀样，Java也有异常处理机制，这使得错误处理相对容易⼀些。
不习惯使⽤异常的程序员，往往会以错误代码表⽰程序遇到的⿇烦。
你可以使⽤ Replace Error Code with Exception（310）来运⽤新的异常特性。
但有时候，异常也并不是最合适的选择，你应该实施 Replace Exception with Test （315）先测试⼀番。